# Linux

#### 리눅스 구성

- 커널 - 
  - 프로세스 관리
  - 파일 시스템
  - 장치 관리
  - 메모리 관리
  - 컴퓨터의  모든 자원 초기화와  제어
- 쉘(shell)
  - 사용자 인터페이스로서 명령어 해석
  - 프로그래밍```.sh``` 
  - 리눅스 기본 쉘 - ```bash shell```
- 응용 프로그램



#### 가상 머신 프로그램

PC에 설치되어 있는 운영체제(호스트 OS)에 가상의 시스템을(머신) 생성한 후에 여기에 다른 운영체제(게스트 OS)를 구성할 수 있도록 해주는 프로그램

-  vmware , virtual box, virtual pc 등
- 리눅스 파티션 구성
  - /: 루트 파티션, 시스템 설정 등 주요 내용 저장
  - /boot: boot 파티션, 리눅스 부팅 커널 저장
  - swap: 메모리(RAM)가 부족할 때 사용되는 영역 (RAM의 2배 size 권장)
  - /usr: 명령어, 응용프로그램 등이 주로 저장
  - /var: 주로 로그 파일 저장
  - /tmp: 시스템 사용 중에 발생하는 임시 파일 저장
  - /home/계정명 : 사용자의 홈 디렉토리로 사용되는 영역



#### 몇 가지 명령어

- ```date```: 현재 날짜, 시간 출력

- ```clear```: 터미널에서 보이는 화면의 내용을 지우고 커서를 화면 ㅈ돠측 상단으로 이동

- ```man```: 리눅스가 제공하는 명령어들의 사용법 보기

- ```passwd```: 비밀번호 변경

- ```exit```, ```ctrl```+```d```: 터미널 종료

  

#### 리눅스 파일의 종류

- 일반파일, 디렉토리, 심볼릭 파일, 디바이스 파일

  - 하드 링크: 기존 파일에 새로운 파일명을 추가로 생성(inode 값이 동일)
  - 심볼릭 링크: 원본 파일을 가리키는 새로운 파일

- ```dev```: 장치 파일이 담긴 디렉토리 

- ```media```: CD-ROM이나 USB 같은 외부 장치를 연결하는 디렉토리: media

- ```opt``` 추가 패키지가 설치되는 디렉토리

-  ```sys```: 리눅스 커널과 관련된 파일이 저장되어 잇는 디렉토리

- ```run```: 실행중인 서비스와 관련된 파일들이 저장되는 디렉토리

- ```proc```: 프로세스 정보 등 커널 관련 정보가 저장되는 디렉토리

  

  

#### 리눅스 파일 관련 명령어

- ```file```: 파일의 종류 확인
- ```ls -l```: 현재 디렉토리 내용의 상세 확인
- ```pwd```: 터미널에서 현재 경로(디렉토리) 확인
- ```cd``` ```cd .``` ```cd ..``` ```cd ../..``` ```cd ~```: 디렉토리 이동
- ```ls -a```: 디렉토리 내용의 숨김파일 포함해서 확인
- ```ls -F``` 디렉토리 내용의 파일 종류
- ```dir``` ```vdir```: ls 명령의 심볼릭 링크
- ```mkdir```: 디렉토리 만들기
- ```mkdir -p``` 중간 디렉토리를 자동으로 생성하는 옵션
- ```rmdir``` ```rmdir -p```: 디렉토리 삭제

- ```cat [파일명]``` ```cat -n``: 텍스트 파일의 내용 확인

- ```more [파일명]```, ```less [ 파일명]```: 텍스트 파일의 내용을 화면 단위로 출력

- ```tail [파일명]```: 텍스트 파일의 니용 중 뒷부분만 일부 출력

- ```cp``` ```cp -r``` : 파일, 디렉토리 복사

- ```mv``` : 파일 이동, 파일 이름 변경

- ```rm``` ```rm -r``` : 파일 삭제, 디렉토리 삭제

- ```ln [원본파일] [심볼릭 링크]``` : 하드 링크 파일 생성

- ```ln -s [원본파일] [심볼릭 링크]``` : 심볼릭 링크

  ***```inode```: 파일에 대한 정보를 가지고 있는 특별한 구조체 (파일의 종류, 크기, 소유자, 파일 변경 시간, 피일 상세 정보, 피일 데이터 블록 주소 저장)***

- ```touch```: 빈 파일 생성, 파일의 수정날짜/시각 변경

- ```grep [검색어] [대상파일명]```: 파일의 내용을 검색

- ```find```: 파일 검색

- ```whereis``` ```which``` : 명령어 위치 파악



#### vi 편집기 (입력모드, 명령모드)

- 입력모드: ```i``` ```a``` ```o```  -> 명령모드: ```esc```

- ```-``` ```k``` : 명령모드에서 커서를 한 행 앞으로

- ```+``` ```j```: 명령모드에서  커서를 한 행 뒤로

- ```:wq``` ```zz```: 저장하고 빠져나오기

- ```q``` ```q!``` : 명령 모드에서 저장 안 하고 vi 종료

- ```행번호G``` ```:행번호```: 명령 모드에서 트정 행으로 이동하려면

- ```x```: 명령 모드에서 커서 위치한 한 글자 삭제

- ```dw```: 명령 모드에서 커서 위치한 한 단어 삭제

- ```dd```: 명령 모드에서 커서 위치한 한 라인 삭제

- ```yy```: 명령 모드에서 커서위차한 한 행 복사

- ```p```: 명령 모드에서 커서 위치한 행 아래 붙여넣기

- ```dd```: 명령 모드에서 커서 위치한 한 행 잘라내기

- ```?검색문자열```: 위 방향으로 특정 문자열 찾기

- ```/검색문자열```: 아래 방향으로 특정 문자열 찾기

- ```:s/문자열1/문자열2/```: 커서가 위치한 행에서 특정 문자열을 다른 문자열로 바꾸기

- ```:%s/문자열1/문자열2/g```: 파일 내용 전체 중 특정 문자열을 다른 문자열로 바꾸기

- ```:r 대상파일```:명령 모드에서 커서가 위치한 행 아래 다른 파일을 읽어들여서 삽입하기

- ```:w``` -> ```:e 대상파일 ```: 명령 모드에서 다른 지정한 파일로 전환하려면

- ```vi test1.txt test2.txt test3.txt``` : test1.txt 편집 후 다음 파일로 전환하려면-> ```:n```

- ```:! 셸명령어```: 편집기 사용 중 셸 명령을 실행시키려면

- ```:sh``` : 편집기 사용 중 셸 명령을 실행시키기 위해 vi  편집기를 빠져나오려면 명령모드에서 사용 (다시 돌아올 때는 ```exit```)

  



### 복습

- 배시 셸
  - 배시 셸의 한 줄의 문자열 출력 : ```echo```
  - 배시 셸의 한 줄 문자열을 %지시자와 W문자를 이용하여 출력 형식을 지정: ```printf```

- 표준 파일 디스크립터

  - 표준입력 파일 디스크립터 : ```stdin``` 0 
  - 표준 출력 파일 디스크립터 : ```stdout``` 1
  - 표준오류 파일 디스크립터 : ```stderr``` 2

- 출력 리다이렉션 :

  -  ```>```:overwrite, 
  - ```>>```:append

  ```bash
  #출력 리다이렉션
  ls -l > ls.out
  ls -l >> ls.out
  
  #입력 리다이렉션
  ls -l < ls.in
  ```

- 변수

  - 셸 변수 - 현재 셸에서만 사용 가능, 서브 셸로는 전달되지 않음
  - 환경 변수 - 현재 셸에서 사용 가능, 서브 셸로로 전달 가능

  ```bash
  #셸 변수, 환경 변수 모두 출력
  set
  
  #환경 변수만 출력
  env
  
  ```

  - 환경변수 종류

    ```HISTSIZE```, ```HOME```, ```LANG```, ```PATH```, ```PWD```, ```SHELL```, ...

  - 셸 변수 정의(설정)

    ```bash
    변수명=문자열 #공백 없어야 한다
    ```

  - 정의된 셸변수를 환경변수로 설정

    ```bash
    export 변수명=문자열 #바로 지정
    export 변수명 #기존 것 지정
    ```

  - 환경변수를 다시 셸변수로 바꾸려면

    ```bash
    alias 이름='명령' #지정
    unalias 이름 #설정 해제
    ```

    

- 히스토리 기능

  - 사용자가 이전에 입력한 명령을 다시 불러와서 사용하려면: `history`
  - 바로 직전에 사용했었던 명령을 재실행하려면: ```!!```
  - 히스토리에서 해당 번호의 명령을 재실행하려면: ```!번호```
  - 히스토리에서 문자열로 시작하는 명령중에서 마지막에 실행된 명령을 재실행하려면: ```!문자열```



- 배시 셸에서 시스템 환경 설정 파일
  - 공통 환경설정
    - /etc/profile - 모든 셸에 공통으로 적용되는 환경 설정, bash.bashrc 파일을 실행시킴
    - /etc/bash.bashrc - 기본 프롬프트 설정, 시스템 공통으로 적용되는 환경 설정
    - /etc/profile.d/*.sh - 언어나 명령별로 필요한 환경을 설
  - 사용자의 환경 설정 파일
    - ~/.profile - 사용자가 정의하는 환경 설정, .bashrc 파일을 실행시킴
    - ~/.bashrc - 히스토리의 크기 설정, alias 설정, 함수 설정
    - ~/.bash_aliases - 사용자가 정의한 alias 를 별도 파일로 저장
    - ~/.bash_logout - 사용자가 logout 할 때 필요한 함수



- ls -l 옵션으로 출력 내용
  - ```-``` or ```d``` : 파일의 종류
  - ```rwxrwxrwx``` : 소유자, 그룹, 아더 파일 접근 권한
  - ```숫자``` : 하드링크 갯수
  - ```소유자 ID```
  - ```소유자의 그룹 이름```
  - ```파일 크기```
  - ```파일이 마지막 수정된 날짜와 시각```
  - ```파일명```



- 파일 접근 권한 

  - 변경 ```chmod```

    - 하위 디렉토리까지 파일 접근 권한 변경: ```chmod -R```
    - 기호 모드 ```+```, ```-```, ```r```, ```w```, ```x```
    - 숫자 모드 ```777```, ```644```  등

  - 기본 접근 권한 ```umask```

    - ```umask```는 파일이나 디렉토리 생성 시 부여하지 않을 권한을 지정함

      

- 특수 접근 권한 ```SetUID```, ```SetGID```, ```sticky bit```

  - ```SetUID```
    - 맨 앞자리가 ```4```로 설정됨.
    - ```SetUID``` 는 해당 파일이 실행되는 동안에는 파일을 실행한 사용자 권한이 아니라 파일 소유자의 권한으로 실행. 
    - 소유자의 실행 권한에 ```s``` 로 표시됨
  -  ```SetGID```
    - 맨 앞자리가 ```2```로 설정됨
    - 해당 파일이 실행되는 동안에는 파일을 실행한 사용자 권한이 아니라 파일 소유자의 그룹권한으로 실행
  - ```sticky bit```
    - 디렉토리에 설정
    - 맨 앞자리가 ```1``` 로 설정됨
    - 설정된 디렉토리에는 누구나 파일을 생성 가능, 다른 사용자가 생성한 파일은 삭제 불가 ```ex. /tmp```

  

- 프로세스

  - 데몬 프로세스 ```deamon```

    - 특정 서비스를 제공하기 위해 존재
    - 리눅스 커널에 의해 실행

  - 고아 프로세스 ```orphan```

    자식 프로세스가 아직 실행 중인데 부모 프로세스가 먼저 종료된 프로세스

  - 좀비 프로세스 ```zombie``` ```(defunct)``` 

    - 자식 프로세스가 종료했는데도 프로세스가 테이블 목록에 남아 있는 경우
    - 좀비 프로세스가 많아지면 새로 프로세스를 실행하지 못 할 수도 있다

  - 현재 실행 중인 프로세스의 목록을 보는 명령: ```ps```

  - 



