package com.DeLa.util;

public class Sort {

	public static boolean QuickSort(int[] array, int nLow, int nHigh)	{
		int lo = nLow;
		int hi = nHigh;
		int pivot = (lo + hi) / 2;
		int nItemLow, nItemHigh, nItemPivot;
	 
		while(true){
			nItemPivot = array[pivot];
	 
			while( lo < pivot ) {
				if( nItemPivot < array[lo] )
					break;
				else
					lo++;
			}
	 
			while( hi > pivot ) {
				if( array[hi] < nItemPivot )
					break;
				else
					hi--;
			}
	 
			if( lo == pivot && hi == pivot) {
				if( nLow < pivot-1  )
					QuickSort(array, nLow, pivot-1);
	   
				if( pivot +1 < nHigh)
					QuickSort(array, pivot+1, nHigh);
	 
				break;
			}
			else {
//				nItemLow = array[lo];
//				nItemHigh = array[hi];
//				array[lo] = nItemHigh;
//				array[hi] = nItemLow;
				int tmp = array[lo];
				array[lo] = array[hi];
				array[hi] = tmp;
			 
				if(lo != pivot && hi != pivot) {
					lo++;
					hi--;
				}
				else if (lo == pivot) {
					pivot = hi;
					lo++;
				}
				else { // hi == pivot
					pivot = lo;
					hi--;
				}
			}
		}
	 
		return true;
	}
	
	
	public static boolean QuickSort(double[] array, int nLow, int nHigh)	{
		int lo = nLow;
		int hi = nHigh;
		int pivot = (lo + hi) / 2;
		double lfItemLow, lfItemHigh, lfItemPivot;
	 
		while(true){
			lfItemPivot = array[pivot];
	 
			while( lo < pivot ) {
				lfItemLow = array[lo];
				if( lfItemPivot < lfItemLow )
					break;
				else
					lo++;
			}
	 
			while( hi > pivot ) {
				lfItemHigh = array[hi];
				if( lfItemHigh < lfItemPivot )
					break;
				else
					hi--;
			}
	 
			if( lo == pivot && hi == pivot) {
				if( nLow < pivot-1  )
					QuickSort(array, nLow, pivot-1);
	   
				if( pivot +1 < nHigh)
					QuickSort(array, pivot+1, nHigh);
	 
				break;
			}
			else {
				lfItemLow = array[lo];
				lfItemHigh = array[hi];
				array[lo] = lfItemHigh;
				array[hi] = lfItemLow;
			 
				if(lo != pivot && hi != pivot) {
					lo++;
					hi--;
				}
				else if (lo == pivot) {
					pivot = hi;
					lo++;
				}
				else { // hi == pivot
					pivot = lo;
					hi--;
				}
			}
		}
	 
		return true;
	}
	
	
	public static boolean QuickSort(float[] array, int nLow, int nHigh)	{
		int lo = nLow;
		int hi = nHigh;
		int pivot = (lo + hi) / 2;
		float fItemLow, fItemHigh, fItemPivot;
	 
		while(true){
			fItemPivot = array[pivot];
	 
			while( lo < pivot ) {
				fItemLow = array[lo];
				if( fItemPivot < fItemLow )
					break;
				else
					lo++;
			}
	 
			while( hi > pivot ) {
				fItemHigh = array[hi];
				if( fItemHigh < fItemPivot )
					break;
				else
					hi--;
			}
	 
			if( lo == pivot && hi == pivot) {
				if( nLow < pivot-1  )
					QuickSort(array, nLow, pivot-1);
	   
				if( pivot +1 < nHigh)
					QuickSort(array, pivot+1, nHigh);
	 
				break;
			}
			else {
				fItemLow = array[lo];
				fItemHigh = array[hi];
				array[lo] = fItemHigh;
				array[hi] = fItemLow;
			 
				if(lo != pivot && hi != pivot) {
					lo++;
					hi--;
				}
				else if (lo == pivot) {
					pivot = hi;
					lo++;
				}
				else { // hi == pivot
					pivot = lo;
					hi--;
				}
			}
		}
	 
		return true;
	}
}