# make geojson
sink("tmp.geojson")
sink()
setwd("c:/R/workspace_R")
sink("tmp.geojson")
sink()
# make geojson
sink("tmp.geojson")
cat("{\"type\": \"FeatureCollection\", \"features\": [");
cat("] }");
sink()
sink("tmp.geojson")
cat("{\"type\": \"FeatureCollection\", \"features\": [");
cat("] }");
sink()
s <- seq(0, 1, by = 0.1)
s <- seq(bounds['left'], bounds['right'], length.out = 100)
s
mode(s)
str(s)
vector_h <- seq(bounds['left'], bounds['right'], length.out = 100)
vector_v <- seq(bounds['top'], bounds['bottom'], length.out = 100)
rm(s)
vector_v
length(vector_h)
i <- 0
len <- length(vector_h)
for(h in vector_h){
i <- i + 1
if(i == len) break;
cat("{ \"type\": \"Feature\", \"properties\": { \"code\": \"")
cat(i)
cat("\", \"name\: \"n\", \"name_eng\": \"n\", \"base_year\": ")
cat("\"2019\" }, \"geometry\": { \"type\": \"Polygon\", ")
cat("\coordinates\": [ [")
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i]); cat("],");
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i+1]); cat("],");
cat("["); cat(vector_v[i+1]); cat(", "); cat(vector_h[i+1]); cat("],");
cat("["); cat(vector_v[i+1]); cat(", "); cat(vector_h[i]); cat("],");
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i]); cat("],");
cat("] ]")
cat("}")
}
cat("] }");
sink()
i <- 0
len <- length(vector_h)
for(h in vector_h){
i <- i + 1
if(i == len) break;
cat("{ \"type\": \"Feature\", \"properties\": { \"code\": \"")
cat(i)
cat("\", \"name\: \"n\", \"name_eng\": \"n\", \"base_year\": ")
cat("\"2019\" }, \"geometry\": { \"type\": \"Polygon\", ")
cat("\coordinates\": [ [")
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i]); cat("],");
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i+1]); cat("],");
cat("["); cat(vector_v[i+1]); cat(", "); cat(vector_h[i+1]); cat("],");
cat("["); cat(vector_v[i+1]); cat(", "); cat(vector_h[i]); cat("],");
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i]); cat("],");
cat("] ]")
cat("}")
};
cat("] }");
sink()
sink("tmp.geojson")
cat("{\"type\": \"FeatureCollection\", \"features\": [");
i <- 0
len <- length(vector_h)
for(h in vector_h){
i <- i + 1
if(i == len) break;
cat("{ \"type\": \"Feature\", \"properties\": { \"code\": \"")
cat(i)
cat("\", \"name\: \"n\", \"name_eng\": \"n\", \"base_year\": ")
cat("\"2019\" }, \"geometry\": { \"type\": \"Polygon\", ")
cat("\coordinates\": [ [")
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i]); cat("],");
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i+1]); cat("],");
cat("["); cat(vector_v[i+1]); cat(", "); cat(vector_h[i+1]); cat("],");
cat("["); cat(vector_v[i+1]); cat(", "); cat(vector_h[i]); cat("],");
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i]); cat("],");
cat("] ]")
cat("}")
};
cat("] }");
sink()
sink("tmp.geojson")
cat("{\"type\": \"FeatureCollection\", \"features\": [");
i <- 0
len <- length(vector_h)
for(h in vector_h){
i <- i + 1
if(i == len) break;
cat("{ \"type\": \"Feature\", \"properties\": { \"code\": \"")
cat(i)
cat("\", \"name\": \"n\", \"name_eng\": \"n\", \"base_year\": ")
cat("\"2019\" }, \"geometry\": { \"type\": \"Polygon\", ")
cat("\coordinates\": [ [")
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i]); cat("],");
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i+1]); cat("],");
cat("["); cat(vector_v[i+1]); cat(", "); cat(vector_h[i+1]); cat("],");
cat("["); cat(vector_v[i+1]); cat(", "); cat(vector_h[i]); cat("],");
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i]); cat("],");
cat("] ]")
cat("}")
}
cat("] }");
sink()
sink("tmp.geojson")
cat("{\"type\": \"FeatureCollection\", \"features\": [");
i <- 0
len <- length(vector_h)
for(h in vector_h){
i <- i + 1
if(i == len) break;
cat("{ \"type\": \"Feature\", \"properties\": { \"code\": \"")
cat(i)
cat("\", \"name\": \"n\", \"name_eng\": \"n\", \"base_year\": ")
cat("\"2019\" }, \"geometry\": { \"type\": \"Polygon\", ")
cat("\"coordinates\": [ [")
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i]); cat("],");
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i+1]); cat("],");
cat("["); cat(vector_v[i+1]); cat(", "); cat(vector_h[i+1]); cat("],");
cat("["); cat(vector_v[i+1]); cat(", "); cat(vector_h[i]); cat("],");
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i]); cat("],");
cat("] ]")
cat("}")
}
cat("] }");
sink()
sink("tmp.geojson")
cat("{\"type\": \"FeatureCollection\", \"features\": [");
i <- 0
len <- length(vector_h)
for(h in vector_h){
i <- i + 1
if(i == 2) break;
cat("{ \"type\": \"Feature\", \"properties\": { \"code\": \"")
cat(i)
cat("\", \"name\": \"n\", \"name_eng\": \"n\", \"base_year\": ")
cat("\"2019\" }, \"geometry\": { \"type\": \"Polygon\", ")
cat("\"coordinates\": [ [")
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i]); cat("],");
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i+1]); cat("],");
cat("["); cat(vector_v[i+1]); cat(", "); cat(vector_h[i+1]); cat("],");
cat("["); cat(vector_v[i+1]); cat(", "); cat(vector_h[i]); cat("],");
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i]); cat("],");
cat("] ]")
cat("}")
}
cat("] }");
sink()
sink("tmp.geojson")
cat("{\"type\": \"FeatureCollection\", \"features\": [");
i <- 0
len <- length(vector_h)
for(h in vector_h){
i <- i + 1
if(i == 2) break;
cat("{ \"type\": \"Feature\", \"properties\": { \"code\": \"")
cat(i)
cat("\", \"name\": \"n\", \"name_eng\": \"n\", \"base_year\": ")
cat("\"2019\" }, \"geometry\": { \"type\": \"Polygon\", ")
cat("\"coordinates\": [ [")
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i]); cat("],");
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i+1]); cat("],");
cat("["); cat(vector_v[i+1]); cat(", "); cat(vector_h[i+1]); cat("],");
cat("["); cat(vector_v[i+1]); cat(", "); cat(vector_h[i]); cat("],");
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i]); cat("]");
cat("] ]")
cat("}")
}
cat("] }");
sink()
i <- 0
len <- length(vector_h)
for(h in vector_h){
i <- i + 1
if(i == len) break;
cat("{ \"type\": \"Feature\", \"properties\": { \"code\": \"")
cat(i)
cat("\", \"name\": \"n\", \"name_eng\": \"n\", \"base_year\": ")
cat("\"2019\" }, \"geometry\": { \"type\": \"Polygon\", ")
cat("\"coordinates\": [ [")
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i]); cat("],");
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i+1]); cat("],");
cat("["); cat(vector_v[i+1]); cat(", "); cat(vector_h[i+1]); cat("],");
cat("["); cat(vector_v[i+1]); cat(", "); cat(vector_h[i]); cat("],");
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i]); cat("]");
cat("] ]")
cat("}")
}
cat(" } ] }");
sink()
sink("tmp.geojson")
cat("{\"type\": \"FeatureCollection\", \"features\": [");
i <- 0
len <- length(vector_h)
for(h in vector_h){
i <- i + 1
if(i == len) break;
cat("{ \"type\": \"Feature\", \"properties\": { \"code\": \"")
cat(i)
cat("\", \"name\": \"n\", \"name_eng\": \"n\", \"base_year\": ")
cat("\"2019\" }, \"geometry\": { \"type\": \"Polygon\", ")
cat("\"coordinates\": [ [")
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i]); cat("],");
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i+1]); cat("],");
cat("["); cat(vector_v[i+1]); cat(", "); cat(vector_h[i+1]); cat("],");
cat("["); cat(vector_v[i+1]); cat(", "); cat(vector_h[i]); cat("],");
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i]); cat("]");
cat("] ]")
cat("}")
}
cat(" } ] }");
sink()
sink("tmp.geojson")
cat("{\"type\": \"FeatureCollection\", \"features\": [");
i <- 0
len <- length(vector_h)
for(h in vector_h){
i <- i + 1
if(i == len) break;
cat("{ \"type\": \"Feature\", \"properties\": { \"code\": \"")
cat(i)
cat("\", \"name\": \"n\", \"name_eng\": \"n\", \"base_year\": ")
cat("\"2019\" }, \"geometry\": { \"type\": \"Polygon\", ")
cat("\"coordinates\": [ [")
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i]); cat("],");
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i+1]); cat("],");
cat("["); cat(vector_v[i+1]); cat(", "); cat(vector_h[i+1]); cat("],");
cat("["); cat(vector_v[i+1]); cat(", "); cat(vector_h[i]); cat("],");
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i]); cat("]");
cat("] ]")
cat("} }")
}
cat("] }");
sink()
sink("tmp.geojson")
cat("{\"type\": \"FeatureCollection\", \"features\": [");
i <- 0
len <- length(vector_h)
for(h in vector_h){
i <- i + 1
if(i == 2) break;
cat("{ \"type\": \"Feature\", \"properties\": { \"code\": \"")
cat(i)
cat("\", \"name\": \"n\", \"name_eng\": \"n\", \"base_year\": ")
cat("\"2019\" }, \"geometry\": { \"type\": \"Polygon\", ")
cat("\"coordinates\": [ [")
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i]); cat("],");
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i+1]); cat("],");
cat("["); cat(vector_v[i+1]); cat(", "); cat(vector_h[i+1]); cat("],");
cat("["); cat(vector_v[i+1]); cat(", "); cat(vector_h[i]); cat("],");
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i]); cat("]");
cat("] ]")
cat("} }")
}
cat("] }");
sink()
sink("tmp.geojson")
cat("{\"type\": \"FeatureCollection\", \"features\": [");
i <- 0
len <- length(vector_h)
for(h in vector_h){
i <- i + 1
if(i == len) break;
cat("{ \"type\": \"Feature\", \"properties\": { \"code\": \"")
cat(i)
cat("\", \"name\": \"n\", \"name_eng\": \"n\", \"base_year\": ")
cat("\"2019\" }, \"geometry\": { \"type\": \"Polygon\", ")
cat("\"coordinates\": [ [")
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i]); cat("],");
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i+1]); cat("],");
cat("["); cat(vector_v[i+1]); cat(", "); cat(vector_h[i+1]); cat("],");
cat("["); cat(vector_v[i+1]); cat(", "); cat(vector_h[i]); cat("],");
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i]); cat("]");
cat("] ]")
if(i != len-1)
cat("} },")
else
cat("} }")
}
cat("] }");
sink()
vector_h <- seq(bounds['left'], bounds['right'], length.out = 101)
vector_v <- seq(bounds['top'], bounds['bottom'], length.out = 101)
sink("tmp.geojson")
cat("{\"type\": \"FeatureCollection\", \"features\": [");
i <- 0
len <- length(vector_h)
for(h in vector_h){
i <- i + 1
if(i == len) break;
cat("{ \"type\": \"Feature\", \"properties\": { \"code\": \"")
cat(i)
cat("\", \"name\": \"n\", \"name_eng\": \"n\", \"base_year\": ")
cat("\"2019\" }, \"geometry\": { \"type\": \"Polygon\", ")
cat("\"coordinates\": [ [")
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i]); cat("],");
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i+1]); cat("],");
cat("["); cat(vector_v[i+1]); cat(", "); cat(vector_h[i+1]); cat("],");
cat("["); cat(vector_v[i+1]); cat(", "); cat(vector_h[i]); cat("],");
cat("["); cat(vector_v[i]); cat(", "); cat(vector_h[i]); cat("]");
if(i != len-1)
cat("] ] } },")
else
cat("] ] } }")
}
cat("] }")
sink()
sink("tmp.geojson")
cat("{\"type\": \"FeatureCollection\", \"features\": [");
i <- 0
len <- length(vector_h)
for(h in vector_h){
i <- i + 1
if(i == len) break;
cat("{ \"type\": \"Feature\", \"properties\": { \"code\": \"")
cat(i)
cat("\", \"name\": \"n\", \"name_eng\": \"n\", \"base_year\": ")
cat("\"2019\" }, \"geometry\": { \"type\": \"Polygon\", ")
cat("\"coordinates\": [ [")
cat("["); cat(vector_h[i]); cat(", "); cat(vector_v[i]); cat("],");
cat("["); cat(vector_h[i]); cat(", "); cat(vector_v[i+1]); cat("],");
cat("["); cat(vector_h[i+1]); cat(", "); cat(vector_v[i+1]); cat("],");
cat("["); cat(vector_h[i+1]); cat(", "); cat(vector_v[i]); cat("],");
cat("["); cat(vector_h[i]); cat(", "); cat(vector_v[i]); cat("]");
if(i != len-1)
cat("] ] } },")
else
cat("] ] } }")
}
cat("] }")
sink()
signif(vector_h, digits = 6)
signif(vector_h, digits = 10)
signif(vector_h, digits = 16)
bounds["left"]
signif(bounds["left"])
signif(bounds["left"], digit=16)
bounds
a <- 126.9002922042051
a
signif(a, digit=16)
print(signif(a, digit=16))
signif(a, digit=16)
print(signif(a, digit=16))
View(spots)
signif(a, digit=16)
options(digits=10)
bounds <- c(
126.9002922042051,
37.63328837459856,
126.94731575472879,
37.609438871986
)
names(bounds) <- c("left", "top", "right", "bottom")
lat <- mean(bounds['bottom'], bounds['top'])
lon <- mean(bounds['left'], bounds['right'])
vector_h <- seq(bounds['left'], bounds['right'], length.out = 101)
vector_v <- seq(bounds['top'], bounds['bottom'], length.out = 101)
signif(a, digit=16)
options(digits=16)
bounds <- c(
126.9002922042051,
37.63328837459856,
126.94731575472879,
37.609438871986
)
names(bounds) <- c("left", "top", "right", "bottom")
lat <- mean(bounds['bottom'], bounds['top'])
lon <- mean(bounds['left'], bounds['right'])
vector_h <- seq(bounds['left'], bounds['right'], length.out = 101)
vector_v <- seq(bounds['top'], bounds['bottom'], length.out = 101)
a
drv <- JDBC("oracle.jdbc.driver.OracleDriver","D:/dev/env/oracle/product/11.2.0/dbhome_1/jdbc/lib/ojdbc6.jar")
conn <- dbConnect(drv, "jdbc:oracle:thin:@localhost:1521/orcl", "hr", "oracle")
stations <- dbGetQuery(conn, paste("SELECT ps_id as id, 0 as type, longitude, latitude FROM prj_pstations WHERE (longitude between", bounds["left"], "and", bounds["right"], ") and (latitude between", bounds["bottom"], "and", bounds["top"], ") order by id"))
cctvs <- dbGetQuery(conn, paste("SELECT cctv_id as id, 1 as type, longitude, latitude FROM prj_cctvs WHERE (longitude between", bounds["left"], "and", bounds["right"], ") and (latitude between", bounds["bottom"], "and", bounds["top"], ") order by id"))
spots <- rbind(stations, cctvs)
rm(list = c("stations", "cctvs"))
sink("tmp.geojson")
cat("{\"type\": \"FeatureCollection\", \"features\": [");
i <- 0
len <- length(vector_h)
for(h in vector_h){
i <- i + 1
if(i == len) break;
cat("{ \"type\": \"Feature\", \"properties\": { \"code\": \"")
cat(i)
cat("\", \"name\": \"n\", \"name_eng\": \"n\", \"base_year\": ")
cat("\"2019\" }, \"geometry\": { \"type\": \"Polygon\", ")
cat("\"coordinates\": [ [")
cat("["); cat(vector_h[i]); cat(", "); cat(vector_v[i]); cat("],");
cat("["); cat(vector_h[i]); cat(", "); cat(vector_v[i+1]); cat("],");
cat("["); cat(vector_h[i+1]); cat(", "); cat(vector_v[i+1]); cat("],");
cat("["); cat(vector_h[i+1]); cat(", "); cat(vector_v[i]); cat("],");
cat("["); cat(vector_h[i]); cat(", "); cat(vector_v[i]); cat("]");
if(i != len-1)
cat("] ] } },")
else
cat("] ] } }")
}
cat("] }")
sink()
spdf <- geojson_read("tmp.geojson",  what = "sp")
spdf_fortified <- tidy(spdf, region = "code")
View(spdf_fortified)
sink("tmp.geojson")
cat("{\"type\": \"FeatureCollection\", \"features\": [ ");
i <- 0
len <- length(vector_h)
for(h in vector_h){
i <- i + 1
if(i == len) break;
cat("\n{ \"type\": \"Feature\", \"properties\": { \"code\": \"")
cat(i)
cat("\", \"name\": \"n\", \"name_eng\": \"n\", \"base_year\": ")
cat("\"2019\" }, \"geometry\": { \"type\": \"Polygon\", ")
cat("\"coordinates\": [ [")
cat("["); cat(vector_h[i]); cat(", "); cat(vector_v[i]); cat("],");
cat("["); cat(vector_h[i]); cat(", "); cat(vector_v[i+1]); cat("],");
cat("["); cat(vector_h[i+1]); cat(", "); cat(vector_v[i+1]); cat("],");
cat("["); cat(vector_h[i+1]); cat(", "); cat(vector_v[i]); cat("],");
cat("["); cat(vector_h[i]); cat(", "); cat(vector_v[i]); cat("]");
if(i != len-1)
cat("] ] } },")
else
cat("] ] } }")
}
cat("] }")
sink()
sink("tmp.geojson")
cat("{\"type\": \"FeatureCollection\", \"features\": [ ");
i <- 0
len <- length(vector_h)
for(h in vector_h){
i <- i + 1
if(i == len) break;
cat("\n{ \"type\": \"Feature\", \"properties\": { \"code\": \"")
cat(i)
cat("\", \"name\": \"n\", \"name_eng\": \"n\", \"base_year\": ")
cat("\"2019\" }, \"geometry\": { \"type\": \"Polygon\", ")
cat("\"coordinates\": [ [")
cat("["); cat(vector_h[i]); cat(", "); cat(vector_v[i]); cat("],");
cat("["); cat(vector_h[i]); cat(", "); cat(vector_v[i+1]); cat("],");
cat("["); cat(vector_h[i+1]); cat(", "); cat(vector_v[i+1]); cat("],");
cat("["); cat(vector_h[i+1]); cat(", "); cat(vector_v[i]); cat("],");
cat("["); cat(vector_h[i]); cat(", "); cat(vector_v[i]); cat("]");
if(i != len-1)
cat("] ] } },")
else
cat("] ] } }")
}
cat("] }")
sink()
sink("tmp.geojson")
cat("{\"type\": \"FeatureCollection\", \"features\": [");
i <- 0
len <- length(vector_h)
for(h in vector_h){
i <- i + 1
if(i == len) break;
cat("{ \"type\": \"Feature\", \"properties\": { \"code\": \"")
cat(i)
cat("\", \"name\": \"n\", \"name_eng\": \"n\", \"base_year\": ")
cat("\"2019\" }, \"geometry\": { \"type\": \"Polygon\", ")
cat("\"coordinates\": [ [")
cat("["); cat(vector_h[i]); cat(", "); cat(vector_v[i]); cat("],");
cat("["); cat(vector_h[i]); cat(", "); cat(vector_v[i+1]); cat("],");
cat("["); cat(vector_h[i+1]); cat(", "); cat(vector_v[i+1]); cat("],");
cat("["); cat(vector_h[i+1]); cat(", "); cat(vector_v[i]); cat("],");
cat("["); cat(vector_h[i]); cat(", "); cat(vector_v[i]); cat("]");
if(i != len-1)
cat("] ] } },")
else
cat("] ] } }")
}
cat("] }")
sink()
# make geojson
sink("tmp.geojson")
sink()
sink()
# make geojson
sink("tmp.geojson")
sink("tmp.geojson")
cat("{\"type\": \"FeatureCollection\", \"features\": [");
i <- 0
len <- length(vector_h)
for(h in vector_h){
i <- i + 1
if(i == len) break;
cat("\n{ \"type\": \"Feature\", \"properties\": { \"code\": \"")
cat(i)
cat("\", \"name\": \"n\", \"name_eng\": \"n\", \"base_year\": ")
cat("\"2019\" }, \"geometry\": { \"type\": \"Polygon\", ")
cat("\"coordinates\": [ [")
cat("["); cat(vector_h[i]); cat(", "); cat(vector_v[i]); cat("],");
cat("["); cat(vector_h[i]); cat(", "); cat(vector_v[i+1]); cat("],");
cat("["); cat(vector_h[i+1]); cat(", "); cat(vector_v[i+1]); cat("],");
cat("["); cat(vector_h[i+1]); cat(", "); cat(vector_v[i]); cat("],");
cat("["); cat(vector_h[i]); cat(", "); cat(vector_v[i]); cat("]");
if(i != len-1)
cat("] ] } },")
else
cat("] ] } }\n")
}
cat("] }")
sink()
