# 4. 데이터 분석 프로세스

## 4.1. 기본 용어

### 4.1.1. 기초통계(descriptive statistics)

데이터에 대한 통계적 자료분석에 앞서 데이터의 대략적인 통계적 수치를 계산해 봄으로써 데이터에 대한 대략적인 이해와 앞으로 진행될 분석에 대한 insight 얻기 위한 분석방법

### 4.1.2. 변수(variable)

수집된 자료에서 관심의 대상이 되는 특성이나 관측된 결과로서 주어지는 특성

### 4.1.3. 변수의 유형

- 질적변수(Qualitative Variable) 또는 범주형 변수(Categorial Variable)

  - 특성을 범주로 구분해서 나타내는 변수
  - 성별구분(남자:1 , 여자 :2) ,  소득수준 (상, 중, 하)

- 양적변수(Quantative Variable)

  - 연속형 변수(continuous Variable)
  - 이산형 변수(Discrete Variable)
  - 관심대상이 되는 특성을 수치로 나타내는 변수
  - 몸무게, 키, 환자의 나이

- 독립변수

  다른 변수에 영향을 주는 변수 (원인변수, 설명변수, 예측변수)

- 종속변수

  - 다른 변수에 영향을 받는 변수 (결과변수, 피설명변수, 피예측변수)
  - '흡연은 폐암을 유발한다'에서  흡연은 독립변수, 폐암은 종속변수

- 자료의 형태에 따른 분류

  | 구분          | 설명                                                         |
  | ------------- | ------------------------------------------------------------ |
  | 명목척도 자료 | 단지 구분하기 위한 부호로 표현된 자료(성별, 혈액형, 주거형태, 학과) |
  | 서열척도 자료 | 관측되는 개체들에 순서를 갖는 자료 (학년, 선호도, 신용등급)  |
  | 구간척도 자료 | 관측 값의 순서와 순서사이의   간경이   의미가 있는 자료 (성적,   온도 등) |
  | 비율척도 자료 | 두 간격(차이)에   대한 비율이 의미를 갖는 자료(연령,   시간,   거리) |

## 4.2. 분석 절차와 통계지식

### 4.2.1. 빅데이터 분석













```R
# 표본오차 구하기
20세 이상 유권자 1,500명 대상으로 A 후보 대선 출마에 대한 찬성과 반대를 조사하는 설문조사를 시행하였다. 설문조사 결과 95% 신뢰수준에서 찬성이 55%, 반대가 45%가 나왔다. 이때 표본오차는?

Z = 1.96
N = 1500
찬성률 p = 55% = 0.55
반대율 1-p = 45% = 0.45

0.025176656
0.025176656

```

- aslkdfjals;kdjf



## 4.3. Quiz

```R
Q1> 다음 중 가설이 갖추어야 할 요건이 아닌 것은? 4
① 가설은 경험적으로 검증할 수 있어야 한다.
②가설은 계량적인 형태를 취하든가 계량화 할 수 있어야 한다.
③가설의 표현은 간단명료해야 한다.
④가설은 동일 분야의 다른 가설과 연관을 가져서는 안된다.

Q2> 다음 중 과학적 연구절차에 기초한 올바른 이론 구축 과정은? 1
① 연구문제 - 개념화 - 가설검정 - 자료수집- 자료분석
② 개념화-연구문제-가설검정- 자료수집- 자료분석
③ 연구문제 -가설검정 -개념화 - 자료수집- 자료분석
④ 개념화 -가설검정 -연구문제 -자료수집- 자료분석

Q3> 가설 검정에 관한 설명으로 옳은 것은? 1
① 검정 통계량은 확률변수이다.
② 대립가설은 사전에 알고 있는 값이다.
③ 유의수준 α를 작게 할수록 좋은 검정법이다.
④ 가설이 틀렸을 때 틀렸다고 판정할 확률을 유의수준이라 한다. 

Q4> '남녀 월급액수에는 차이가 있다'라는 주장을 검증하기 위하여 사회조사를 시행하였다.
조사결과 남자집단의 평균액수는 μ1, 여자집단의 μ2라고 한다면, 귀무가설은? 2
①  μ1 > μ2
②  μ1 = μ2
③  μ1 < μ2
④  μ1 ≠ μ2

Q5> 가설구성 시 고려할 사항이 아닌 것은? 4
① 경험적 검증이 가능하여야 한다.
② 다른 가설 및 이론과의 연관성을 가져야 한다.
③ 두 개 이상의 변수 간의 관계로 서술되어야 한다.
④ 한 가설에 독립변수나 종속변수 수가 많아지도록 한다.

Q6> 가설의 특성이라고 할 수 없는 것은? 4
① 문제를 해결해 줄 수 있어야 한다. 
② 변수로 구성되며, 그들 간의 관계를 나타내고 있어야 하낟.
③ 검증될 수 있어야 한다.
④ 매개변수가 있어야 한다.

Q7> 유의확률(p-value)의 설명이 틀린 것은? 2
①  검정 통계량이 실제 관측된 값보다 대립가설을 지지하는 방항으로 더욱 치우칠 확률로서 귀무가설 하에서 계산된 값이다
② 주어진 데이터와는 직접적으로 관계가 없다.
③ 유의확률이 낮을 수록 반증이 강한 것을 뜻한다.
④ 귀무가설에 대한 반증의 강도에 대하여 기준값을 미리 정해놓고 p-value값을 그 기준값과 비교한다.

Q8> 다음 내용에 대한 가설형태로 옳은 것은? 2
기존의 진통제는 진통효과가 지속되는 시간이 평균 30분이고, 표준편차는 5분이라고 한다. 
새로운 진통제를 개발하였는데, 개발팀은 이 진통제의 진통 효과가 30분 이상이라고 주장한다.
① H0 : μ<30, H1: μ=30
② H0 : μ=30, H1: μ>30
③ H0 : μ>30, H1: μ=30
④ H0 : μ=30, H1: μ≠30

Q9> 모집단의 회귀계수β에 대한 표본 회귀계수가 0.23일 경우, 독립변수가 종속변수에 의미 있는
영향을 미치는지를 알기 위해 모집단 회귀계수에 대한 가설 검정을 하려곻 라때 귀무가설과 대립가설은? 1
① H0 : β= 0, H1: β≠ 0
② H0 : β≠ 0, H1: β= 0
③ H0 : β= 0.23, H1: β≠ 0.23
④ H0 : β≠ 0.23, H1: β= 0.23

11> 통계적 검증 오류중 제 1종 오류에 해당하는 것은? 1
① 귀무가설이 참임에도 불구하고 이를 기각
② 귀무가설이 참이므로 이를 채택
③ 귀무가설이 거짓이므로 채택
④ 귀무가설이 거짓임에도 이를 기각

12> 통계적 가설의 기각 여부를 판정하는 가설 검정에 대한 설명으로 맞는 것은? 4
① 표본으로부터 확실한 근거에 의하여 입증하고자 하는 가설을 귀무가설이라 한다.
② 유의수준은 제2종 오류를 범할 확률의 최대허용한계이다.
③ 대립가설을 채택하게 하는 검정 통계량의 영역을 채택역이라 한다.
④ 대립가설이 옳은데도 귀무가설을 채택함으로써 범하게 되는 오류를 제2종 오류라 한다.

13> 통계적 가설 검정을 위한 검정 통계값에 대한 유의확률(p-value)이 주어졌을 때, 귀무가설을 유의수준 α 로 기각할 수 있는 경우는? 2
① p-value >  α
② p-value <  α
③ p-value =  α
④ p-value >  2α

14> 정규분포의 특성에 대한 설명으로 틀린 것은? 2
① 평균, 중위수, 최빈수가 모두 일치한다.
② X=μ에 관해 종 모양의 좌우대칭이고, 이 점에서 확률 밀도함수가 최대값 1/0을 갖는다.
③ 분포의 기울어진 방향과 정도를 나타내는 지표는 왜도이다.
④ 분포의 봉우리가 얼마나 뾰족한가를 나타내는 지표 첨도이다.

15> 보험가입액의 모평균이 1억 원이라고 볼 수 있는가를 검정하고자 한다. 이에 대한 t-검정 통계량이 1.201이고, 유의확률이 0.239이었다. 
① '유의확률 > 유의수준'이므로 모평균이 1억 원이라는 가설을 기각하지 못한다.
② '유의확률 > 유의수준'이므로 모평균이 1억 원이라는 가설을 기각한다.
③ '검정 통계량 1.201 >유의수준'이므로 모평균이 1억 원이라는 가설을 기각하지 못한다.
④ '검정 통계량 1.201 >유의수준'이므로 모평균이 1억 원이라는 가설을 기각한다.

16> '표본의 크기가 충분히 크다면, 표본의 평규은 0에 가까워진다.'는 이론은?
중심극한정리(The central limit theorem)

Q17> 표준화 변환을 하면 변환된 자료의 평균과 표준편차의 값은? 1
① 평균 = 0, 표준편차 = 1
② 평균 = 1, 표준편차 = 1
③ 평균 = 1, 표준편차 = 0
④ 평균 = 0, 표준편차 = 0

Q18> 신뢰수준에 대한 설명으로 틀린 것은? 4
① 신뢰구간에 확신하는 정도를 의미한다.
② 신뢰수준은 연구자가 결정한다.
③ 신뢰수준이 95%라는 의미는 표본오차가 ±5%라는 의미이다.
④ 신뢰수준 높이면 신뢰구간은 넓어진다. -> (좁아진다)

Q19> A회사에서 만든 제품의 수명의 표준편차는 50이라고 한다. 새로운 공정
에 의해 제품 100개를 생산하여 실험한 결과 수명의 평균이 280이었다.
모 평균에 대한 95% 오차 한계는? 1
①  9.8
②  12.9
③   98
④  129

Q20> 크기가 n표본으로 신뢰수준 95%를 갖도록 모평균을 추정하였더니 
신뢰구간의 길이가 10이었다. 동일한 조건 아래 표본의 크기만을 1/4로 줄이면
신뢰구간의 길이는? 3
①  1/4로 줄어든다
②  1/2로 줄어든다
③  2배로 늘어난다.
④  4배로 늘어난다.

Q21> 어느 고등학교 1학년 1,000명의 성적분포가 평균 80점, 표준편차 20점인 정규분포로 나타났다.
이경우에 60점 이상 100점 이하의 점수를 얻은 학생은 대략 몇 명인가? 2
①  350
②  680
③  790
④  850
```

## 4.4. 기술 통계 분석

- 기술통계량

  ```R
  data <- read.csv("./data/descriptive.csv", header=T)
  
  # resident - 거주지역
  # gender - 성별(명목 1, 2)
  # age - 연령
  # level - 학력수준(서열 1, 2, 3)
  # cost - 생활비(비율)
  # type - 학교유형(명목 1, 2)
  # survey - 만족도(등간척도 5점)
  # pass - 합격여부(명목 1, 2)
  
  dim(data)
  [1] 300   8
  
  length(data) # 변수 개수(열)
  length(data$servey) # 관측치 개수(행)
  
  fivenum(data) # minimum, lower-hinge, median, upper-hinge, maximum
  summary(data) # 컬럼 단위로 최솟값, 최댓값, 평균, 1and3분위수, 결측치, 중앙값(중위수) 등
  
  
  # 명목척도의 기술 통계량(결측치제거 > 빈도수 > 비율 > 백분율)
  length(data$gender) # 관측치 확인
  summary(dat$gender) # 명목척도는 최솟값, 최댓값, 평균 등 의미가 없음
  # 각 성별의 빈도수
  tabel(data$gender)
  # 결측치 제거 후 시각화
  data <- subset(data, data$gender == 1 | data$gender == 2)
  x <- table(data$gender) # 빈도수에 따른 분할표
  barplot(x)
  # 비율 계산
  y <- prop.table(x)
  # 백분율로 변환
  round(y*100, 2)
  
  
  # 서열척도의 기술 통계량
  summary(data$level) # 서열척도도 최솟값, 최댓값, 평균 등 의미없음 -> ???
  x1 <- table(data$level)
  barplot(x1)
  y1 <- prop.table(x1)
  round(y1 * 100, 2)
  barplot(y1)
  
  
  # 등간척도의 기술 통계량
  survey <- data$survey
  summary(survey) # 등간척도에서 평균 통계량은 어느 정도 의미가 있다.
     Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NAs 
     1.00    2.00    3.00    2.61    3.00    5.00     113
  x2 <- table(survey) # 빈도수는 의미 있음
  hist(survey) #등간척도 시각화(히스토그램)
  pie(x2) #빈도수를 이용한 시각화 - 파이 차트
  
  
  # 비율척도의 기술 통계량
  length(data$cost)
  summary(data$cost) # 요약 통계 - 의미 있음
  plot(data$cost)	# 이상치 발견
  boxplot(data$cost) # 이상치 발견
  data2 <- subset(data, data$cost >= 2 & data$cost <= 10)
  x3 <- data2$cost
  mean(x3); median(x3) # 평균이 극단치에 영향을 받는 경우 중위수로 대체하는 것이 더 효과적
  # 예
  A반 성적 = 75, 80, 80, 80, 85 	평균:80 중위수:80
  B반 성적 = 75, 75, 75, 75, 100 평균:80 중위수:75
  # 사분위값
  quantile(x3, 1/4) # 1사분위 수
  quantile(x3, 2/4) # 중앙값과 동일
  quantile(x3, 3/4) #
  quantile(x3, 4/4)
  # 최빈수 - 빈도수가 가장 많은 변량
  x3.t <- table(x3)
  x.max <- sort(x.t, decreasing=T)[1]
  as.numeric(names(x.max)[1])
  # 다른방법
  x3.m <- rbind(x3.t)
  x3.df <- as.data.frame3.m)
  x3.df
  which(x3.df[1,]==18) # 특정 값을 지닌 인덱스를 알려줌
  [1] 25
  names(x3.df[25])
  
  
  # 산포도는 분산과 표준편차를 통계량으로 사용
  
  
  # 비율척도의 빈도 분석 : 비율척도를 범주화(리코딩)
  table(data$cost)
  hist(data$cost)
  plot(data$cost)
  
  
  # 연속형(비율척도) 변수 범주화
  data$cost2[data$cost >=1 & data$cost<=3] <- 1
  data$cost2[data$cost >=4 & data$cost<=6] <- 2
  data$cost2[data$cost >=7 ] <- 3
  table(data$cost2)
  barplot(table(data$cost2))
  pie(table(data$cost2))
  
  
  # 정규분포를 갖는 지 확인 - 왜도, 첨도
  install.packages("moments")
  library(moments)
  cost <- data$cost[!is.na(data$cost)]
  skewness(cost) # 왜도 반환 0보다 크면, 0보다 작으면...
  [1] 2.486237
  hist(cost)
  hist(cost, freq=F) # 히스토그램의 계급을 확률 밀도로 표현
  lines(density(cost), col="blue") #cost의 밀도 분포 곡선
  x <- seq(0, 8, 0.1) # 0~8 범위의 0.1씩 증가하는 데이터 벡터 생성
  curve(dnorm(x, mean(cost), sd(cost)), col='red', add=T)
  
  # attach() /detach()
  #리스트객체$key, dataframe객체$컬럼변수
  #attach()함수는 dataframe객체$컬럼변수로부터  dataframe객체 데이터셋 이름을 생략하고 컬럼변수만으로 관측치에 사용가능
  #detach()함수는  dataframe객체$컬럼변수로 관측치에 접근
  data <- read.csv("./data/descriptive.csv", header=T)
  # 원래 접근 방식
  length(data$survey)
  summary(data$cost)
  # attach 접근 방식
  attach(data)
  length(survey)
  summary(cost)
  # detach
  detach(data)
  length(survey) #오류
  summary(cost) #오류
  
  
  # Hmisc 패키지
  install.packages("Hmisc")
  library(Hmisc)
  describe(data)
  
  # prettyR 패키지
  install.packages("prettyR")
  library(prettyR)
  freq(data)
  
  # Quiz> 거주지역 변수 리코딩 후 비율 계산
  # 1은 특별시, 2~4는 광역시, 5는 시군구
  # 빈도수, 비율, 백분율
  resident <- data$resident[!is.na(data$resident)]
  resident[resident == 1] <- "특별시"
  resident[2 <= resident & resident <= 4 ] <- "광역시"
  resident[resident == 5] <- "시군구"
  freq(resident)
  
  # Quiz> 성별 변수 리코딩 후 비율 계산
  # 범주화 : 1은 남자, 2는 여자
  # 빈도수, 비율, 백분율
  gender <- data$gender[data$gender == 1 | data$gender == 2]
  gender[gender == 1] <- "남자"
  gender[gender == 2] <- "여자"
  freq(gender)
  
  # Quiz> 나이변수 리코딩 후 비율 계산
  # 범주화 : <= 45 중년층, 46~69 장년층, >=60 노년층
  # 빈도수, 비율, 백분율
  age <- data$age[!is.na(data$age)]
  age[age <= 45] <- 1 #문자열로 바꾸니 자동형변환 때문에 귀찮은 일이 생겨서 숫자로
  age[46 <= age & age <= 69] <- 2
  age[age >= 70] <- 3
  freq(age)
  
  ```

- 표본추출

  ```R
  # 샘플링
  # 80대 20
  # 과적합 (분리하지 않고...)
  
  # 단순 임의 추출
  sample(1:10, 5, replace = T) #복원 추출
  sample(1:10, 5) #비복원 추출
  # 가중치 사용시 prob 파라미처 사용
  
  
  # 층화 임의 추출
  sampling::ska.....
  install.packages("sampling")
  library(sampling)
  head(iris)
  result <- strata(c("Species"), size=c(3, 3, 3), method="srswor", data=iris)
  # srswor: 비복원 단순 임의 추출
  # srswr : 복원 단순 임의 추출
  # poisson : 포아송 추출
  # systematic : 계통 추출
  
  # 계통 추출
  install.packages("doBy")
  library(doBy)
  x <- data.frame(x=1:10)
      x
  1   1
  2   2
  3   3
  4   4
  5   5
  6   6
  7   7
  8   8
  9   9
  10 10
  sampleBy(~1, frac=0.3, data=x, systematic=T)
    [,1] [,2] [,3]
  1    1    4    7
  
  
  # 분할표Contingency Table
  table(c("a", "b", "b", "b", "c", "c", "d"))
  d <- data.frame(x=c("1", "2", "2", "1"),  y=c("A", "B", "A", "B"),   num=c(3, 5, 8, 7))
    x y num
  1 1 A   3
  2 2 B   5
  3 2 A   8
  4 1 B   7
  xtabs(num ~ x + y, data=d)
     y
  x   A B
    1 3 7
    2 8 5
  d2 <- data.frame(x=c("A", "A", "A", "B", "B"))
  xtabs(~ x, d2)
  x
  A B 
  3 2 
  # margin.table 주변?
  xt <- xtabs(num ~ x + y, data = d)
     y
  x   A B
    1 3 7
    2 8 5
  margin.table(xt, 1) #행
  x
   1  2 
  10 13 
  margin.table(xt, 2) #열
  y
   A  B 
  11 12 
  margin.table(xt) # 전체
  [1] 23
  # prop.table : 분할표에 대해서 각각의 비율을 반환해 주는 함수
  prop.table(xt, 1)
     y
  x           A         B
    1 0.3000000 0.7000000
    2 0.6153846 0.3846154
  prop.table(xt, 2)  #  3/11, 7/12
                        8/11, 5/12
  
  prop.table(xt)     #  3/23, 7/23
                        8/23, 5/23
  
  
  ```

- 교차 분석

  ```R
  #교차분석을 위한 변수 모델링
  
  ```

  